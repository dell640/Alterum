#include <stdio.h>
#include <time.h>
#include <pthread.h>
#include <mydefs.h>



unsigned int moje=0;


char me_run=1;


void *Thread1( void );
void *Thread2( void );
void *Thread3( void );



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////MAIN MAIN MAIN ///////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
main()
{
    
    uart_init();
    
     pthread_t thread1, thread2, thread3;

     if(pthread_create( &thread1, NULL, Thread1, 0)){fprintf(stderr,"Error create Thread1\n"); exit(1);}
     if(pthread_create( &thread2, NULL, Thread2, 0)){fprintf(stderr,"Error create Thread2\n"); exit(1);}
     if(pthread_create( &thread3, NULL, Thread3, 0)){fprintf(stderr,"Error create Thread3\n"); exit(1);}

     printf("Threads running!\n");

     pthread_join( thread1, NULL);
     pthread_join( thread2, NULL); 
     pthread_join( thread3, NULL); 


     printf("program OVER\n");
     
     exit(0);
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////   THREAD   1   //////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void *Thread1( void )
{    
    while(me_run){

        usleep(1);
        moje++;
        
    }
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////   THREAD   2   //////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void *Thread2( void )
{    
    while(me_run){

       // uart_read();
        usleep(1);
        moje++;
        
    }
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////   THREAD   3   //////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void *Thread3( void ) 
{    
    while(me_run){

    usleep(20000);
    LEDgrn(1);
    usleep(20000);
    LEDgrn(0);
        
        
    uart_test_send();
    sleep(1);
    }
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////